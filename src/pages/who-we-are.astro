---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import configData from '../../data/config.json';

// Get featured podcasts using the featuredPodcasts array from config
// The order in the array determines display order (1st = left, 2nd = middle, 3rd = right)
const featuredPodcasts = configData.featuredPodcasts
    .map((podcastId) =>
        configData.podcasts.find((podcast) => podcast.id === podcastId),
    )
    .filter((podcast) => podcast !== undefined);

// Parse date helper for podcasts
const parsePodcastDate = (dateString: string): Date => {
    const months: { [key: string]: number } = {
        January: 0,
        February: 1,
        March: 2,
        April: 3,
        May: 4,
        June: 5,
        July: 6,
        August: 7,
        September: 8,
        October: 9,
        November: 10,
        December: 11,
    };

    const parts = dateString.split(" ");
    if (parts.length === 3) {
        const month = months[parts[0]];
        const day = parseInt(parts[1].replace(",", ""));
        const year = parseInt(parts[2]);
        return new Date(year, month, day);
    }
    return new Date(dateString);
};

// Get latest podcasts - sort all podcasts by date and get the latest ones
const latestPodcasts = [...configData.podcasts]
    .map((podcast) => ({
        ...podcast,
        publishedDate: parsePodcastDate(podcast.date),
    }))
    .sort((a, b) => b.publishedDate.getTime() - a.publishedDate.getTime())
    .slice(0, 3); // Get top 3 most recent

// Load all blog posts
const allBlogPosts = await import.meta.glob('../../data/blog/*.mdx', { 
    eager: true,
    import: 'frontmatter'
});

// Convert to array with slug
const blogPosts = Object.entries(allBlogPosts).map(([path, frontmatter]: [string, any]) => {
    const fileName = path.split('/').pop()?.replace('.mdx', '') || '';
    return {
        slug: fileName,
        ...frontmatter,
        publishedAtDate: new Date(frontmatter.publishedAt)
    };
});

// Get featured blogs from config
const featuredBlogs = configData.featuredBlogs
    .map((slug: string) => blogPosts.find(blog => blog.slug === slug))
    .filter((blog: any) => blog !== undefined);

// Get latest blogs - sort all blogs by publishedAt and get the latest ones
const latestBlogs = [...blogPosts]
    .sort((a, b) => b.publishedAtDate.getTime() - a.publishedAtDate.getTime())
    .slice(0, 3); // Get top 3 most recent

// Format date helper
const formatDate = (dateString: string) => {
    const date = new Date(dateString);
    return date.toLocaleDateString('en-US', { 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
    });
};
---

<BaseLayout 
  title="Who We Are - 42 Interactive"
  bodyClass=""
>
    <Header activePage="who-we-are" />
    
    <main class="main-content">
        
        <!-- ========================================
             SECTION 1: WHO WE ARE (Black Background)
             ======================================== -->
        <section class="who-we-are-section stars-bg" data-theme="dark">
            
            <!-- Hero Section -->
            <div class="hero-section">
                <h1 class="hero-title">Who We Are</h1>
            </div>

            <!-- Vision Section -->
            <div class="vision-section">
                <div class="section-label">our vision</div>
                <h2 class="vision-title">
                    <span>Building </span>
                    <span class="regular">What Others Only</span>
                    <span> Imagine</span>
                </h2>
            </div>

            <!-- What We Do Section -->
            <div class="what-we-do-section">
                <div class="section-label">WHAT WE DO</div>
                <p class="what-we-do-text">
                    We <strong>Design</strong> and <strong>Develop</strong> <strong>Web</strong>, <strong>App</strong> & <strong>AI</strong> <strong>Interactive Experiences,</strong> that deepen the connection between Brands and Audiences.
                </p>
            </div>

            <!-- Our History Section -->
            <div class="history-section">
                <div class="section-label">OUR HISTORY</div>
                <div class="history-content">
                    <p class="history-text">
                        42 Interactive began with a small group of people who cared deeply about good design and thoughtful technology. After years in fast agency environments where the craft was often overlooked, we wanted to build a studio that did things differently. A place where work is created with intention and clarity.
                    </p>
                    <p class="history-text">
                        As we grew, we partnered with major organisations while staying true to that original focus on craft and purpose. We remained small enough to care about every detail and skilled enough to deliver work at a global standard. Today, that same commitment guides everything we make.
                    </p>
                </div>
            </div>

            <!-- Crew Carousel Section -->
            <div class="crew-carousel-section">
                <div class="carousel-row">
                    <div class="carousel-track">
                        <img src="/images/crew/image-crew-1.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-2.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-3.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-4.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-6.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-7.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-8.png" alt="Team Member" class="carousel-image">
                        <!-- Duplicate for seamless loop -->
                        <img src="/images/crew/image-crew-1.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-2.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-3.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-4.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-6.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-7.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-8.png" alt="Team Member" class="carousel-image">
                    </div>
                </div>
                <div class="carousel-row carousel-row-reverse">
                    <div class="carousel-track">
                        <img src="/images/crew/image-crew-9.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-10.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-11.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-12.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-13.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-14.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-15.png" alt="Team Member" class="carousel-image">
                        <!-- Duplicate for seamless loop -->
                        <img src="/images/crew/image-crew-9.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-10.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-11.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-12.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-13.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-14.png" alt="Team Member" class="carousel-image">
                        <img src="/images/crew/image-crew-15.png" alt="Team Member" class="carousel-image">
                    </div>
                </div>
            </div>

            <!-- Don't Panic Section -->
            <div class="dont-panic-section">
                <h2 class="dont-panic-title">DON'T PANIC</h2>
                <p class="dont-panic-text">
                    <strong>42 is the answer</strong> to the ultimate question of life, the universe and everything, said Deep thought supercomputer after seven and a half million years of thought. Taken from "<strong>The Hitchhiker's Guide to the Galaxy</strong>" novel series by Douglas Adams.<br/>We liked the idea and use the number as our name, with space exploration and technology as our brand theme.
                </p>
            </div>
            
        </section>

        <!-- ========================================
             SECTION 2: OUR STORY (White Background)
             ======================================== -->
        <section class="our-story-section" data-theme="light">
            <div class="section-inner">
                <!-- Our Story Title -->
                <div class="story-title-section">
                    <h2 class="story-title">Our Story</h2>
                </div>

                <!-- Featured Podcasts Section -->
                <div class="podcasts-section">
                    <div class="section-label">FEATURED PODCASTS</div>
                    <div class="podcasts-grid">
                        {
                            featuredPodcasts.map((podcast) => (
                                <div
                                    class="youtube-video-card"
                                    data-video-id={podcast.id}
                                >
                                    <div class="youtube-thumbnail">
                                        <img
                                            src={`https://img.youtube.com/vi/${podcast.id}/maxresdefault.jpg`}
                                            alt={podcast.title}
                                            class="podcast-image"
                                        />
                                        <div class="play-button">
                                            <svg
                                                width="68"
                                                height="48"
                                                viewBox="0 0 68 48"
                                                fill="none"
                                            >
                                                <path
                                                    d="M66.52,7.74c-0.78-2.93-2.49-5.41-5.42-6.19C55.79,.13,34,0,34,0S12.21,.13,6.9,1.55 C3.97,2.33,2.27,4.81,1.48,7.74C0.06,13.05,0,24,0,24s0.06,10.95,1.48,16.26c0.78,2.93,2.49,5.41,5.42,6.19 C12.21,47.87,34,48,34,48s21.79-0.13,27.1-1.55c2.93-0.78,4.64-3.26,5.42-6.19C67.94,34.95,68,24,68,24S67.94,13.05,66.52,7.74z"
                                                    fill="#f00"
                                                />
                                                <path
                                                    d="M 45,24 27,14 27,34"
                                                    fill="#fff"
                                                />
                                            </svg>
                                        </div>
                                    </div>
                                    <h3 class="podcast-title">
                                        {podcast.title}
                                    </h3>
                                    <p class="podcast-date">{podcast.date}</p>
                                </div>
                            ))
                        }
                    </div>
                </div>

                <!-- Latest Podcasts Section -->
                <div class="podcasts-section" style="display: none;">
                    <div class="section-label">LATEST PODCASTS</div>
                    <div class="podcasts-grid">
                        {
                            latestPodcasts.map((podcast) => (
                                <div
                                    class="youtube-video-card"
                                    data-video-id={podcast.id}
                                >
                                    <div class="youtube-thumbnail">
                                        <img
                                            src={`https://img.youtube.com/vi/${podcast.id}/maxresdefault.jpg`}
                                            alt={podcast.title}
                                            class="podcast-image"
                                        />
                                        <div class="play-button">
                                            <svg
                                                width="68"
                                                height="48"
                                                viewBox="0 0 68 48"
                                                fill="none"
                                            >
                                                <path
                                                    d="M66.52,7.74c-0.78-2.93-2.49-5.41-5.42-6.19C55.79,.13,34,0,34,0S12.21,.13,6.9,1.55 C3.97,2.33,2.27,4.81,1.48,7.74C0.06,13.05,0,24,0,24s0.06,10.95,1.48,16.26c0.78,2.93,2.49,5.41,5.42,6.19 C12.21,47.87,34,48,34,48s21.79-0.13,27.1-1.55c2.93-0.78,4.64-3.26,5.42-6.19C67.94,34.95,68,24,68,24S67.94,13.05,66.52,7.74z"
                                                    fill="#f00"
                                                />
                                                <path
                                                    d="M 45,24 27,14 27,34"
                                                    fill="#fff"
                                                />
                                            </svg>
                                        </div>
                                    </div>
                                    <h3 class="podcast-title">
                                        {podcast.title}
                                    </h3>
                                    <p class="podcast-date">{podcast.date}</p>
                                </div>
                            ))
                        }
                    </div>
                </div>

                <!-- Show All Podcasts Button -->
                <div class="podcasts-section" style="text-align: center; margin-top: 40px;">
                    <a href="/podcasts" class="btn-show-all">Show All Podcasts</a>
                </div>

                <!-- Featured Blogs Section -->
                <div class="podcasts-section">
                    <div class="section-label">FEATURED BLOGS</div>
                    <div class="podcasts-grid">
                        {
                            featuredBlogs.map((blog) => (
                                <a href={`/blog/${blog.slug}`} class="youtube-video-card" style="text-decoration: none;">
                                    {blog.image ? (
                                        <div class="youtube-thumbnail">
                                            <img
                                                src={blog.image}
                                                alt={blog.title}
                                                class="podcast-image"
                                            />
                                        </div>
                                    ) : (
                                        <div class="youtube-thumbnail">
                                            <div class="podcast-image" style="background-color: #1a1a1a; display: flex; align-items: center; justify-content: center; min-height: 200px;">
                                                <span style="color: #666;">No Image</span>
                                            </div>
                                        </div>
                                    )}
                                    <h3 class="podcast-title">
                                        {blog.title}
                                    </h3>
                                    <p class="podcast-date">{formatDate(blog.publishedAt)}</p>
                                </a>
                            ))
                        }
                    </div>
                </div>

                <!-- Latest Blogs Section -->
                <div class="podcasts-section" style="display: none;">
                    <div class="section-label">LATEST BLOGS</div>
                    <div class="podcasts-grid">
                        {
                            latestBlogs.map((blog) => (
                                <a href={`/blog/${blog.slug}`} class="youtube-video-card" style="text-decoration: none;">
                                    {blog.image ? (
                                        <div class="youtube-thumbnail">
                                            <img
                                                src={blog.image}
                                                alt={blog.title}
                                                class="podcast-image"
                                            />
                                        </div>
                                    ) : (
                                        <div class="youtube-thumbnail">
                                            <div class="podcast-image" style="background-color: #1a1a1a; display: flex; align-items: center; justify-content: center; min-height: 200px;">
                                                <span style="color: #666;">No Image</span>
                                            </div>
                                        </div>
                                    )}
                                    <h3 class="podcast-title">
                                        {blog.title}
                                    </h3>
                                    <p class="podcast-date">{formatDate(blog.publishedAt)}</p>
                                </a>
                            ))
                        }
                    </div>
                </div>

                <!-- Show All Blogs Button -->
                <div class="podcasts-section" style="text-align: center; margin-top: 40px;">
                    <a href="/blog" class="btn-show-all">Show All Blogs</a>
                </div>
            
        </section>
        
    </main>

    <Footer />
</BaseLayout>

